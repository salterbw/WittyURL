// Generated by CoffeeScript 1.6.3
(function() {
  jQuery(document).ready(function() {
    $(".add-comment").click(function(e) {
      var comment;
      e.preventDefault();
      comment = $(this).parent().parent().find(".newComment");
      $(this).remove();
      console.log("Add a comment link has been removed from the DOM.");
      console.log(comment);
      comment.find("input[type=text], textarea").val("");
      comment.slideDown();
      console.log("Comment has been made viewable.");
      return comment.find("#newComment").click(function(e) {
        e.preventDefault();
        return $.ajax({
          type: "POST",
          url: "newComment",
          data: $("form").serialize(),
          success: function() {
            var numCom;
            comment.slideUp();
            numCom = $("#numComm");
            numCom.fadeOut(function() {
              return numCom.text(parseInt(numCom.text()) + 1);
            });
            return numCom.fadeIn();
          }
        });
      });
    });
    return $("article").find("#newComment").click(function(e) {
      var form;
      e.preventDefault();
      form = $("form");
      return $.ajax({
        type: "POST",
        url: "../newComment",
        data: form.serialize(),
        success: function() {
          var author, comment, element;
          author = form.find("input[type=text]").val();
          comment = form.find("textarea").val();
          element = $('<article>', {
            "class": "comment",
            style: "display: none;"
          }).append($('<h1>' + author + '</h1>')).append($('<p>' + comment + '</p>'));
          $(".comments").prepend(element);
          $(".comment").slideDown();
          return $(".newComment").slideUp();
        }
      });
    });
  });

}).call(this);
